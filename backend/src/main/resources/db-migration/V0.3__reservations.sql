set schema 'BIT_HACK';

CREATE TABLE RESERVATION
(
    ID                    BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    COMMUNITY_HOUSE_ID    BIGINT       NOT NULL,
    PURPOSE_ID            BIGINT       NOT NULL,
    USER_ID               BIGINT       NOT NULL,
    RESERVATION_AMOUNT_ID BIGINT,
    RECORD_ID             BIGINT,
    BANK                  VARCHAR(255) NOT NULL,
    IBAN                  VARCHAR(255) NOT NULL,
    LOCAL_BOARD_NAME      VARCHAR(255),
    ISSUE_DATE            date         NOT NULL,
    DATE_TIME_FROM        TIMESTAMP    NOT NULL,
    DATE_TIME_TO          TIMESTAMP    NOT NULL,
    STATUS                SMALLINT     NOT NULL,
    CREATED_AT            TIMESTAMP    NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    UPDATED_AT            TIMESTAMP    NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    CREATED_BY            VARCHAR(255) NOT NULL,
    UPDATED_BY            VARCHAR(255) NOT NULL
);

CREATE TABLE RESERVATION_AMOUNT
(
    ID         BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    RENT       DECIMAL(10, 2) NOT NULL,
    GUARANTEE  DECIMAL(10, 2) NOT NULL,
    PAYOFF     DECIMAL(10, 2) NOT NULL,
    PDV        DECIMAL(10, 2) NOT NULL,
    CREATED_AT TIMESTAMP      NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    UPDATED_AT TIMESTAMP      NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    CREATED_BY VARCHAR(255)   NOT NULL,
    UPDATED_BY VARCHAR(255)   NOT NULL
);

CREATE TABLE RECORD
(
    ID                 BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    STATE_BEFORE       VARCHAR(255) NOT NULL,
    STATE_AFTER        VARCHAR(255) NOT NULL,
    DAMAGE             VARCHAR(255),
    PROBLEMS           VARCHAR(255),
    DATE_OF_INSPECTION date         NOT NULL,
    STATUS             CHAR(2),
    CREATED_AT         TIMESTAMP    NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    UPDATED_AT         TIMESTAMP    NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    CREATED_BY         VARCHAR(255) NOT NULL,
    UPDATED_BY         VARCHAR(255) NOT NULL
);


ALTER TABLE RESERVATION
    ADD FOREIGN KEY (COMMUNITY_HOUSE_ID) REFERENCES COMMUNITY_HOUSE (ID);

ALTER TABLE RESERVATION
    ADD FOREIGN KEY (PURPOSE_ID) REFERENCES PURPOSE (ID);

ALTER TABLE RESERVATION
    ADD FOREIGN KEY (USER_ID) REFERENCES USERS (ID);

ALTER TABLE RESERVATION
    ADD FOREIGN KEY (RESERVATION_AMOUNT_ID) REFERENCES RESERVATION_AMOUNT (ID);

ALTER TABLE RESERVATION
    ADD FOREIGN KEY (RECORD_ID) REFERENCES RECORD (ID);


-- Inserting data

-- RECORD table
INSERT INTO RECORD (STATE_BEFORE, STATE_AFTER, DAMAGE, PROBLEMS, DATE_OF_INSPECTION, STATUS, CREATED_BY, UPDATED_BY)
VALUES
    ('Good', 'Good', NULL, NULL, '2023-06-16', '01', 'system', 'system'),
    ('Good', 'Satisfactory', 'Minor scratches', NULL, '2023-07-11', '02', 'system', 'system'),
    ('Satisfactory', 'Good', NULL, 'Broken chair', '2023-08-21', '02', 'system', 'system'),
    ('Good', 'Good', NULL, NULL, '2023-09-06', '02', 'system', 'system'),
    ('Good', 'Good', NULL, 'Malfunctioning AC', '2023-10-13', '02', 'system', 'system');

-- RESERVATION_AMOUNT table
INSERT INTO RESERVATION_AMOUNT (RENT, GUARANTEE, PAYOFF, PDV, CREATED_BY, UPDATED_BY)
VALUES
    (100.00, 50.00, 150.00, 25.00, 'system', 'system'),
    (200.00, 100.00, 300.00, 50.00, 'system', 'system'),
    (150.00, 75.00, 225.00, 37.50, 'system', 'system'),
    (120.00, 60.00, 180.00, 30.00, 'system', 'system'),
    (180.00, 90.00, 270.00, 45.00, 'system', 'system');

-- RESERVATION table
INSERT INTO RESERVATION (COMMUNITY_HOUSE_ID, PURPOSE_ID, USER_ID, RESERVATION_AMOUNT_ID, RECORD_ID, BANK, IBAN, LOCAL_BOARD_NAME, ISSUE_DATE, DATE_TIME_FROM, DATE_TIME_TO, STATUS, CREATED_BY, UPDATED_BY)
VALUES
    (1, 1, 1, 1, 1, 'Bank A', 'HR1234567890', 'Local Board 1', '2023-06-01', '2023-06-15 10:00:00', '2023-06-15 18:00:00', '01', 'system', 'system'),
    (2, 2, 2, 2, 2, 'Bank B', 'HR9876543210', 'Local Board 2', '2023-07-01', '2023-07-10 12:00:00', '2023-07-10 20:00:00', '02', 'system', 'system'),
    (3, 3, 3, 3, 3, 'Bank C', 'HR5678901234', 'Local Board 3', '2023-08-01', '2023-08-20 09:00:00', '2023-08-20 17:00:00', '03', 'system', 'system'),
    (4, 4, 4, 4, 4, 'Bank D', 'HR4321098765', 'Local Board 4', '2023-09-01', '2023-09-05 14:00:00', '2023-09-05 22:00:00', '04', 'system', 'system');

