set schema 'BIT_HACK';

CREATE TABLE CATEGORY
(
    ID             BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME           VARCHAR(255)   NOT NULL,
    OVERHEAD_PRICE DECIMAL(10, 2) NOT NULL,
    CREATED_AT     TIMESTAMP      NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    UPDATED_AT     TIMESTAMP      NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    CREATED_BY     VARCHAR(255)   NOT NULL,
    UPDATED_BY     VARCHAR(255)   NOT NULL
);

CREATE TABLE PURPOSE
(
    ID         BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME       VARCHAR(255) NOT NULL,
    CREATED_AT TIMESTAMP    NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    UPDATED_AT TIMESTAMP    NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    CREATED_BY VARCHAR(255) NOT NULL,
    UPDATED_BY VARCHAR(255) NOT NULL
);

CREATE TABLE PURPOSE_CATEGORY_PRICE
(
    ID              BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PURPOSE_ID      BIGINT         NOT NULL,
    CATEGORY_ID     BIGINT         NOT NULL,
    PRICE_PER_METER DECIMAL(10, 2) NOT NULL,
    CREATED_AT      TIMESTAMP      NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    UPDATED_AT      TIMESTAMP      NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    CREATED_BY      VARCHAR(255)   NOT NULL,
    UPDATED_BY      VARCHAR(255)   NOT NULL
);

CREATE TABLE COORDINATES(
    ID        BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    LATITUDE  DECIMAL(10, 8) NOT NULL,
    LONGITUDE DECIMAL(11, 8) NOT NULL,
    CREATED_AT TIMESTAMP NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    UPDATED_AT TIMESTAMP NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    CREATED_BY VARCHAR(255) NOT NULL,
    UPDATED_BY VARCHAR(255) NOT NULL
);

CREATE TABLE COMMUNITY_HOUSE
(
    ID                             BIGINT GENERATED BY DEFAULT AS IDENTITY,
    CATEGORY_ID                    BIGINT NOT NULL,
    COORDINATES_ID                 BIGINT,
    NAME                           VARCHAR(255)   NOT NULL,
    ADDRESS                        VARCHAR(255)   NOT NULL,
    SQUARING                       DECIMAL(10, 2) NOT NULL,
    CUTLERY_RENT_AMOUNT_PER_PERSON DECIMAL(10, 2),
    APROX_NUMBER_OF_OCCUPANTS      DECIMAL(10, 2),
    NOTE                           VARCHAR(255),
    ACTIVE                         BOOLEAN        NOT NULL DEFAULT true,
    CREATED_AT                     TIMESTAMP      NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    UPDATED_AT                     TIMESTAMP      NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    CREATED_BY                     VARCHAR(255)   NOT NULL,
    UPDATED_BY                     VARCHAR(255)   NOT NULL,
    PRIMARY KEY (ID),
    CONSTRAINT FK_COMMUNITY_HOUSE_CATEGORY_ID FOREIGN KEY (CATEGORY_ID) REFERENCES CATEGORY (ID)
);

CREATE TABLE NON_WORKING_DAYS
(
    ID                 BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    COMMUNITY_HOUSE_ID BIGINT       NOT NULL,
    DAY_OF_WEEK        INTEGER      NOT NULL,
    CREATED_AT         TIMESTAMP    NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    UPDATED_AT         TIMESTAMP    NOT NULL DEFAULT (CURRENT_TIMESTAMP),
    CREATED_BY         VARCHAR(255) NOT NULL,
    UPDATED_BY         VARCHAR(255) NOT NULL
);

ALTER TABLE PURPOSE_CATEGORY_PRICE ADD FOREIGN KEY (PURPOSE_ID) REFERENCES PURPOSE (ID);

ALTER TABLE PURPOSE_CATEGORY_PRICE ADD FOREIGN KEY (CATEGORY_ID) REFERENCES CATEGORY (ID);

ALTER TABLE COMMUNITY_HOUSE ADD FOREIGN KEY (CATEGORY_ID) REFERENCES CATEGORY (ID);

ALTER TABLE NON_WORKING_DAYS ADD FOREIGN KEY (COMMUNITY_HOUSE_ID) REFERENCES COMMUNITY_HOUSE (ID);


-- DATA SEED

INSERT INTO COORDINATES (LATITUDE, LONGITUDE, CREATED_BY, UPDATED_BY)
VALUES
    (45.897497, 16.847827, 'system', 'system'),
    (45.8987, 16.8484, 'system', 'system'),
    (45.8987, 16.8484, 'system', 'system'),
    (45.8987, 16.8484, 'system', 'system'),
    (45.8987, 16.8484, 'system', 'system');

INSERT INTO CATEGORY (NAME, OVERHEAD_PRICE, CREATED_BY, UPDATED_BY)
VALUES
    ('Category I', 3.87, 'system', 'system'),
    ('Category II', 2.90, 'system', 'system');

-- PURPOSE table
INSERT INTO PURPOSE (NAME, CREATED_BY, UPDATED_BY)
VALUES
    ('Wedding', 'system', 'system'),
    ('Birthday Party', 'system', 'system'),
    ('Business Meeting', 'system', 'system'),
    ('Funeral', 'system', 'system');

-- PURPOSE_CATEGORY_PRICE table
INSERT INTO PURPOSE_CATEGORY_PRICE (PURPOSE_ID, CATEGORY_ID, PRICE_PER_METER, CREATED_BY, UPDATED_BY)
VALUES
    (1, 1, 10.00, 'system', 'system'),
    (1, 2, 8.00, 'system', 'system'),
    (2, 1, 8.00, 'system', 'system'),
    (2, 2, 6.00, 'system', 'system'),
    (3, 1, 6.00, 'system', 'system'),
    (3, 2, 5.00, 'system', 'system'),
    (4, 1, 5.00, 'system', 'system'),
    (4, 2, 4.00, 'system', 'system');

INSERT INTO COMMUNITY_HOUSE (CATEGORY_ID, COORDINATES_ID, NAME, ADDRESS, SQUARING, CUTLERY_RENT_AMOUNT_PER_PERSON, APROX_NUMBER_OF_OCCUPANTS, NOTE, ACTIVE, CREATED_BY, UPDATED_BY)
VALUES
    (1, 1, 'I MO HRGOVLJANI', 'Ulica Zrinska 2a, Bjelovar', 171.27, 0.40, NULL, 'PONEDJELJAK I SRIJEDA- NE IZNAJMLJIVATI', TRUE, 'system', 'system'),
    (1, 2, 'I MO GUDOVAC', 'Ulica Zrinska 2a, Bjelovar', 263.2, 0.40, 135, NULL, TRUE, 'system', 'system'),
    (2, NULL, 'II PROKLJUVANI', 'Ulica Zrinska 2a, Bjelovar', 84, NULL, NULL, NULL, TRUE, 'system', 'system'),
    (1, NULL, 'I MO KOKINAC', 'Ulica Zrinska 2a, Bjelovar', 124.41, NULL, NULL, NULL, TRUE, 'system', 'system'),
    (1, NULL, 'I MO NOVOSELJANI', 'Ulica Zrinska 2a, Bjelovar', 148.93, NULL, NULL, NULL, TRUE, 'system', 'system');


INSERT INTO NON_WORKING_DAYS (COMMUNITY_HOUSE_ID, DAY_OF_WEEK, CREATED_BY, UPDATED_BY)
VALUES
    (1, 1, 'system', 'system'),
    (1, 3, 'system', 'system'),
    (2, 5, 'system', 'system'),
    (2, 5, 'system', 'system'),
    (3, 6, 'system', 'system'),
    (3, 0, 'system', 'system');

